#!/bin/bash

echo "üîß Manual Staging Resource Creation Commands"
echo "============================================="
echo ""
echo "Since wrangler requires authentication, please run these commands manually:"
echo ""

echo "1Ô∏è‚É£  CREATE STAGING D1 DATABASES:"
echo "================================"
echo ""
echo "# Create main recipe database for staging"
echo "wrangler d1 create recipe-db-staging"
echo ""
echo "# Create search database for staging" 
echo "wrangler d1 create recipe-search-db-staging"
echo ""

echo "2Ô∏è‚É£  CREATE STAGING R2 BUCKETS:"
echo "==============================="
echo ""
echo "# Create staging image bucket"
echo "wrangler r2 bucket create recipe-images-staging"
echo ""

echo "3Ô∏è‚É£  AFTER CREATION, UPDATE CONFIG FILES:"
echo "========================================"
echo ""
echo "The commands above will output database IDs like:"
echo '‚úÖ Successfully created DB "recipe-db-staging" in region WEUR'
echo '  database_id = "abc123-def456-ghi789"'
echo ""
echo "Copy those database IDs and update these files:"
echo ""
echo "üìù clipped-recipe-db-worker/wrangler.toml:"
echo "   Replace: REPLACE_WITH_STAGING_DB_ID"
echo "   With: [the database_id from recipe-db-staging]"
echo ""
echo "üìù recipe-search-db/wrangler.toml:"
echo "   Replace: REPLACE_WITH_STAGING_SEARCH_DB_ID"
echo "   With: [the database_id from recipe-search-db-staging]"
echo ""

echo "4Ô∏è‚É£  RUN DATABASE MIGRATIONS:"
echo "============================"
echo ""
echo "# Migrate main recipe database"
echo "cd clipped-recipe-db-worker"
echo "wrangler d1 execute recipe-db-staging --file=schema.sql --env staging"
echo "cd .."
echo ""
echo "# Migrate search database"
echo "cd recipe-search-db"
echo "wrangler d1 execute recipe-search-db-staging --file=schema.sql --env staging"
echo "cd .."
echo ""

echo "5Ô∏è‚É£  VALIDATE CONFIGURATION:"
echo "==========================="
echo ""
echo "./validate-environments.sh"
echo ""

echo "6Ô∏è‚É£  DEPLOY TO STAGING:"
echo "====================="
echo ""
echo "./deploy-staging.sh"
echo ""

echo "üìã SUMMARY OF RESOURCES TO CREATE:"
echo "=================================="
echo "‚Ä¢ recipe-db-staging (D1 database)"
echo "‚Ä¢ recipe-search-db-staging (D1 database)"  
echo "‚Ä¢ recipe-images-staging (R2 bucket)"
echo ""
echo "‚úÖ KV namespace already configured: 3f8a3b17db9e4f8ea3eae83d864ad518"
echo ""
echo "üîí This will complete the environment isolation and prevent data leakage!"